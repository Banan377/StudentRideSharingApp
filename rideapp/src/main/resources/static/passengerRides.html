<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <title>صفحة الحجز</title>
  <link rel="stylesheet" href="passenger.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>

  <div class="sidebar">
    <div class="logo"></div>
    <ul class="menue">
      <li><a href="bookingPage.html"><i class="fas fa-home"></i><span>الصفحة الرئيسية</span></a></li>
      <li><a href="#"><i class="fas fa-history"></i><span>سجل الرحلات</span></a></li>
      <li><a href="#"><i class="fas fa-bell"></i><span>الإشعارات</span></a></li>
      <li><a href="#"><i class="fas fa-school"></i><span>أنشطة الجامعة</span></a></li>
    </ul>
  </div>

  <main class="main-content">

    <div class="container">
      <div class="header">
        <button type="button" class="book-btn">احجز الآن</button>
      </div>

      <div class="profile-section">
        <button onclick="toggleProfileDropdown()" class="profile-btn">
          <i class="fas fa-user-circle"></i>
        </button>

        <div id="profile-dropdown" class="dropdown-menu hidden" aria-hidden="true">
          <ul>
            <li><a href="#" onclick="showRatingPage()"><i class="fas fa-star"></i><span>سجل
                  التقييمات</span></a></li>
            <li><a href="passengerSetting.html"><i class="fas fa-cog"></i><span>الإعدادات</span></a></li>
            <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i><span>تسجيل
                  الخروج</span></a></li>
          </ul>
        </div>
      </div>
    </div>
    </div>

    <!-- صفحات كاملة (مخفية افتراضياً) -->
    <div id="rating-page" class="full-page hidden">
      <div class="container-form">
        <div class="form-box">
          <div class="page-header">
            <button onclick="closePage()" class="back-btn"><i class="fas fa-arrow-right"></i></button>
            <h2>سجل التقييمات</h2>
          </div>
          <div class="rating-history">
            <div class="rating-summary">
              <div class="average-rating">
                <span class="rating-number">0.0</span>
                <div class="stars-display">
                  <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                  <i class="fas fa-star"></i><i class="fas fa-star"></i>
                </div>
                <span class="total-reviews">(0 تقييم)</span>
                <p>ستظهر تقييماتك هنا بعد إكمال الرحلات</p>
              </div>
            </div>
            <div class="reviews-list">
              <div class="no-reviews">
                <i class="fas fa-star"></i>
                <p>لا توجد تقييمات بعد</p>
                <span>ستظهر تقييمات الركاب هنا بعد إكمال الرحلات</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    
    <button class="switch-role-btn" id="switchRoleBtn" onclick="showUploadModal()">
      <i class="fas fa-car"></i>
      <span>كن سائقاً</span>
    </button> </div>
    </div><!-- Upload Modal -->
    <div class="upload-modal hidden" id="uploadModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>طلب أن تصبح سائقاً</h2><button class="close-btn" onclick="closeUploadModal()"> <i
              class="fas fa-times"></i> </button>
        </div><!-- Requirements -->
        <div class="requirements">
          <h4><i class="fas fa-info-circle"></i> المتطلبات المطلوبة:</h4>
          <ul>
            <li>رخصة قيادة سارية المفعول</li>
            <li>استمارة تسجيل المركبة</li>
            <li>يجب أن تكون الوثائق واضحة ومقروءة</li>
            <li>صيغ الملفات المقبولة: JPG, PNG, PDF (حد أقصى 5 ميجابايت)</li>
          </ul>
        </div><!-- Upload Form -->
        <form id="uploadForm"><!-- License Upload -->
          <div class="upload-section"><label for="licenseUpload"> <i class="fas fa-id-card"></i> رخصة القيادة * </label>
            <div class="file-upload-area" onclick="document.getElementById('licenseUpload').click()"><input type="file"
                id="licenseUpload" accept=".jpg,.jpeg,.png,.pdf" required>
              <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i>
              </div>
              <div class="upload-text">
                اضغط هنا لرفع رخصة القيادة
              </div>
              <div class="upload-subtext">
                أو اسحب الملف هنا
              </div>
            </div>
            <div class="file-info" id="licenseInfo"><i class="fas fa-check-circle"></i> <span class="file-name"></span>
              <button type="button" class="remove-file" onclick="removeFile('license')"> <i class="fas fa-times"></i>
              </button>
            </div>
          </div><!-- Vehicle Registration Upload -->
          <div class="upload-section"><label for="registrationUpload"> <i class="fas fa-file-alt"></i> استمارة تسجيل
              المركبة * </label>
            <div class="file-upload-area" onclick="document.getElementById('registrationUpload').click()"><input
                type="file" id="registrationUpload" accept=".jpg,.jpeg,.png,.pdf" required>
              <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i>
              </div>
              <div class="upload-text">
                اضغط هنا لرفع استمارة تسجيل المركبة
              </div>
              <div class="upload-subtext">
                أو اسحب الملف هنا
              </div>
            </div>
            <div class="file-info" id="registrationInfo"><i class="fas fa-check-circle"></i> <span
                class="file-name"></span> <button type="button" class="remove-file"
                onclick="removeFile('registration')"> <i class="fas fa-times"></i> </button>
            </div>
          </div><!-- Submit Button --> <button type="submit" class="submit-btn" id="submitBtn" disabled> <i
              class="fas fa-paper-plane"></i> إرسال الطلب </button> <!-- Success Message -->
          <div class="success-message" id="successMessage">
            <h4><i class="fas fa-check-circle"></i> تم إرسال طلبك بنجاح!</h4>
            <p>سيتم مراجعة طلبك خلال 24-48 ساعة وسنقوم بإشعارك بالنتيجة</p>
          </div>
        </form>
      </div>
    </div>

    <!-- صفحة الإعدادات -->
    <div id="settings-page" class="full-page hidden">
      <div class="container-form">
        <div class="form-box">
          <div class="page-header">
            <button onclick="closePage()" class="back-btn"><i class="fas fa-arrow-right"></i></button>
            <h2>الإعدادات</h2>
          </div>

          <div class="settings-form">
            <div class="form-group">
              <label for="name">الاسم</label>
              <input type="text" id="name" placeholder="أدخل اسمك">
            </div>

            <div class="form-group">
              <label for="password">كلمة المرور</label>
              <input type="password" id="password" placeholder="أدخل كلمة المرور الجديدة">
            </div>

            <div class="form-group">
              <label for="emergency-contact">جهة الاتصال الطارئة</label>
              <input type="tel" id="emergency-contact" placeholder="رقم الهاتف للطوارئ">
            </div>

            <button onclick="updateSettings()" class="update-btn">تحديث المعلومات</button>
          </div>
        </div>
      </div>
    </div>


     <script>

      /* ---------------- القائمة ---------------- */
      function toggleProfileDropdown() {
        document.getElementById('profile-dropdown').classList.toggle('hidden');
      }

      document.addEventListener('click', function (event) {
        const profile = document.querySelector('.profile-section');
        const dropdown = document.getElementById('profile-dropdown');
        if (!profile.contains(event.target)) dropdown.classList.add('hidden');
      });

      /* ---------------- الصفحات ---------------- */
      function showRatingPage() {
        document.getElementById('rating-page').classList.remove('hidden');
      }

      function showSettingsPage() {
        document.getElementById('settings-page').classList.remove('hidden');
      }

      function closePage() {
        document.querySelectorAll('.full-page').forEach(p => p.classList.add('hidden'));
      }

      /* ---------------- تسجيل الخروج ---------------- */
      function logout() {
        document.getElementById('profile-dropdown').classList.add('hidden');

        const overlay = document.createElement('div');
        overlay.className = 'logout-overlay';
        overlay.innerHTML = `
        <div class="logout-modal">
          <div class="logout-content">
            <i class="fas fa-sign-out-alt logout-icon"></i>
            <h3>تسجيل الخروج</h3>
            <p>هل أنت متأكد؟</p>
            <div class="logout-buttons">
              <button onclick="confirmLogout()" class="confirm-logout-btn">نعم</button>
              <button onclick="cancelLogout()" class="cancel-logout-btn">إلغاء</button>
            </div>
          </div>
        </div>`;
        document.body.appendChild(overlay);
      }

      function confirmLogout() {
        localStorage.removeItem("currentUser");
        localStorage.removeItem("userEmail");
        localStorage.removeItem("resetPasswordMode");

        const overlay = document.querySelector('.logout-overlay');
        overlay.innerHTML = `
        <div class="logout-modal">
          <div class="logout-content success">
            <i class="fas fa-check-circle success-icon"></i>
            <h3>تم تسجيل الخروج</h3>
            <button onclick="closeLogoutSuccess()" class="success-btn">موافق</button>
          </div>
        </div>`;
      }

      function cancelLogout() {
        document.querySelector('.logout-overlay').remove();
      }

      function closeLogoutSuccess() {
        document.querySelector('.logout-overlay').remove();
        window.location.href = "login.html";
      }

      /* ---------------- رفع الملفات ---------------- */

      let uploadedFiles = { license: null, registration: null };

      function showUploadModal() {
        document.getElementById('uploadModal').classList.remove('hidden');
      }

      function closeUploadModal() {
        document.getElementById('uploadModal').classList.add('hidden');
      }

      function setupFileUpload(inputId, infoId, type) {
        const input = document.getElementById(inputId);
        const info = document.getElementById(infoId);

        input.addEventListener('change', function (e) {
          const file = e.target.files[0];
          if (!file) return;

          uploadedFiles[type] = file;
          info.querySelector('.file-name').textContent = file.name;
          info.classList.add('show');
          checkFormCompletion();
        });
      }

      function checkFormCompletion() {
        const btn = document.getElementById('submitBtn');
        btn.disabled = !(uploadedFiles.license && uploadedFiles.registration);
      }

      document.addEventListener('DOMContentLoaded', () => {
        setupFileUpload('licenseUpload', 'licenseInfo', 'license');
        setupFileUpload('registrationUpload', 'registrationInfo', 'registration');
      });

    </script>
</body>

</html>